<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sessions</title>
    <link rel="icon" href="public/Untitled_logo_1_free-file.jpg" />
    <link rel="stylesheet" href="styles/player.css" />
    <link rel="stylesheet" href="styles/style.css" />
    <link rel="stylesheet" href="styles/home.css" />
  </head>

  <body>
    <div class="progress-player" style="background-color: #e8162e"></div>
    <header>
      <div class="left">
        <h1 style="color: #e8162e; font-size: 2.4rem !important">
          VIDEO<span id="recording"
            ><img
              src="public/record.png"
              height="50"
              width="50"
              alt="recording" /></span
          >SCOP
        </h1>
        <button id="player">SESSIONS</button>
      </div>

      <div class="right settings">
        <button id="settings-btn">
          <img
            src="public/settings.svg"
            alt="settings"
            height="55"
            width="55"
          />
        </button>
      </div>
    </header>

    <div class="search">
      <input type="search" placeholder="Search..." id="search-input" />
      <svg
        class="loupe"
        version="1.1"
        id="Capa_1"
        xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink"
        x="0px"
        y="0px"
        viewBox="0 0 451 451"
        style="enable-background: new 0 0 451 451"
        xml:space="preserve"
      >
        <g>
          <path
            d="M447.05,428l-109.6-109.6c29.4-33.8,47.2-77.9,47.2-126.1C384.65,86.2,298.35,0,192.35,0C86.25,0,0.05,86.3,0.05,192.3 s86.3,192.3,192.3,192.3c48.2,0,92.3-17.8,126.1-47.2L428.05,447c2.6,2.6,6.1,4,9.5,4s6.9-1.3,9.5-4 C452.25,441.8,452.25,433.2,447.05,428z M26.95,192.3c0-91.2,74.2-165.3,165.3-165.3c91.2,0,165.3,74.2,165.3,165.3 s-74.1,165.4-165.3,165.4C101.15,357.7,26.95,283.5,26.95,192.3z"
          ></path>
        </g>
      </svg>
      <div class="latest-sessions">
        <p>Latest Sessions:</p>
        <div class="arhiv"></div>
        <div class="more-btn">
          <svg
            class="custom-icon rotated-150"
            version="1.1"
            id="Capa_1"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            x="0px"
            y="0px"
            viewBox="0 0 477.175 477.175"
            style="enable-background: new 0 0 477.175 477.175"
            xml:space="preserve"
          >
            <g>
              <path
                style="fill: #fff"
                d="M360.731,229.075l-225.1-225.1c-5.3-5.3-13.8-5.3-19.1,0s-5.3,13.8,0,19.1l215.5,215.5l-215.5,215.5c-5.3,5.3-5.3,13.8,0,19.1c2.6,2.6,6.1,4,9.5,4c3.4,0,6.9-1.3,9.5-4l225.1-225.1C365.931,242.875,365.931,234.275,360.731,229.075z"
              ></path>
            </g>
          </svg>
          <button id="show-more-btn">SHOW MORE</button>
          <svg
            class="custom-icon rotated-90"
            version="1.1"
            id="Capa_1"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            x="0px"
            y="0px"
            viewBox="0 0 477.175 477.175"
            style="enable-background: new 0 0 477.175 477.175"
            xml:space="preserve"
          >
            <g>
              <path
                style="fill: #fff"
                d="M360.731,229.075l-225.1-225.1c-5.3-5.3-13.8-5.3-19.1,0s-5.3,13.8,0,19.1l215.5,215.5l-215.5,215.5c-5.3,5.3-5.3,13.8,0,19.1c2.6,2.6,6.1,4,9.5,4c3.4,0,6.9-1.3,9.5-4l225.1-225.1C365.931,242.875,365.931,234.275,360.731,229.075z"
              ></path>
            </g>
          </svg>
        </div>
      </div>
    </div>

    <div class="sidebar">
      <ul>
        <button class="remove-sidebar" src="public/ARROW.svg">
          <svg
            class="custom-icon"
            version="1.1"
            id="Capa_1"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            x="0px"
            y="0px"
            viewBox="0 0 477.175 477.175"
            style="enable-background: new 0 0 477.175 477.175"
            xml:space="preserve"
          >
            <g>
              <path
                style="fill: #fff"
                d="M360.731,229.075l-225.1-225.1c-5.3-5.3-13.8-5.3-19.1,0s-5.3,13.8,0,19.1l215.5,215.5l-215.5,215.5c-5.3,5.3-5.3,13.8,0,19.1c2.6,2.6,6.1,4,9.5,4c3.4,0,6.9-1.3,9.5-4l225.1-225.1C365.931,242.875,365.931,234.275,360.731,229.075z"
              ></path>
            </g>
          </svg>
        </button>
        <li id="exit">LOGOUT FROM PROFILE</li>
        <li id="back-on-main"><a href="#">BACK ON MAIN</a></li>
        <div class="sidebar-footer">
          <li><a href="#">CONTACTS</a></li>
          <li><a href="#">POLITICS</a></li>
          <li><a href="#">ABOUT US</a></li>
        </div>
      </ul>
    </div>

    <div class="player-container">
      <video id="video-player" controls>
        <source id="video-source" type="video/webm" />
        YOUR BROWSER DOES NOT SUPPORT THE VIDEO ELEMENT.
      </video>

      <canvas id="heatmap-canvas"></canvas>

      <div class="controls">
        <div class="controls-button">
          <img src="/public/ARROW2.svg" alt="backward" class="icon" />
          <button id="frame-backward" class="btn">FRAME BACK</button>
        </div>

        <button id="toggle-heatmap" class="btn primary">
          DRAW / RESET HEAT MAP
        </button>

        <div class="controls-button">
          <button id="frame-forward" class="btn">FRAME FORWARD</button>
          <img src="/public/ARROW2.svg" alt="forward" class="icon" />
        </div>
      </div>
    </div>
    <script src="script.js"></script>
    <script src="heat.js"></script>
    <script src="main.js"></script>
    <script>
      const scop = document
        .querySelector('h1')
        .addEventListener('click', () => {
          window.location.href = 'home.html';
        });
      const back = document
        .querySelector('#back-on-main')
        .addEventListener('click', () => {
          window.location.href = 'home.html';
        });

      document.addEventListener('DOMContentLoaded', async () => {
        const videoPlayer = document.getElementById('video-player');
        const heatmapCanvas = document.getElementById('heatmap-canvas');
        const ctx = heatmapCanvas.getContext('2d');
        const frameBackwardButton = document.getElementById('frame-backward');
        const frameForwardButton = document.getElementById('frame-forward');
        const toggleHeatmapButton = document.getElementById('toggle-heatmap');

        let isHeatmapVisible = false;
        let dataset = [];
        let training = { currentModel: null };

        try {
          // Получаем список видео с сервера
          const response = await fetch('https://example.com/upload/video.mp4', {
            headers: {
              Authorization: `Bearer ${localStorage.getItem('access_token')}`,
            },
          });

          if (!response.ok) {
            throw new Error('Ошибка получения видео');
          }

          const videos = await response.json();

          if (videos.length > 0) {
            // Берем последнее видео (или можно реализовать выбор)
            const latestVideo = videos[videos.length - 1];

            // Устанавливаем источник видео
            videoPlayer.src = `"https://example.com/upload/video.mp4"
}/${latestVideo.id}/stream`;
            videoPlayer.load();
          } else {
            alert('Видео не найдено!');
          }
        } catch (error) {
          console.error('Ошибка:', error);
          alert('Ошибка при загрузке видео: ' + error.message);
        }

        // Обработчики кнопок остаются без изменений
        frameBackwardButton.addEventListener('click', () => {
          videoPlayer.currentTime = Math.max(0, videoPlayer.currentTime - 0.07);
        });

        frameForwardButton.addEventListener('click', () => {
          videoPlayer.currentTime = Math.min(
            videoPlayer.duration,
            videoPlayer.currentTime + 0.07
          );
        });
      });
    </script>
  </body>
</html>

<!-- <div class="error-message">
    THERE WAS AN ERROR LOADING THE MODEL
    <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    class="error-svg"
    viewBox="0 0 24 24"
  >
    <path
      fill="currentColor"
      d="M12.5 8.752a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0Z"
    />
    <circle cx="11.999" cy="16.736" r=".5" fill="currentColor" />
    <path
      fill="currentColor"
      d="M18.642 20.934H5.385a2.5 2.5 0 0 1-2.222-3.644L9.792 4.421a2.5 2.5 0 0 1 4.444 0l6.629 12.869a2.5 2.5 0 0 1-2.223 3.644M12.014 4.065a1.478 1.478 0 0 0-1.334.814L4.052 17.748a1.5 1.5 0 0 0 1.333 2.186h13.257a1.5 1.5 0 0 0 1.334-2.186L13.348 4.879a1.478 1.478 0 0 0-1.334-.814"
    /></svg>
</div> -->

<!-- <div class="buttonrow">
  <button id="draw-heatmap" disabled>Нарисовать тепловую карту</button>
  <button id="clear-heatmap" disabled>Очистить тепловую карту</button>
</div> -->
